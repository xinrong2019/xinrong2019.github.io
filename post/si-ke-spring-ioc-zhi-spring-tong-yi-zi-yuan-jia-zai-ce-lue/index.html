<!DOCTYPE html>
<html lang="zh-CN">

<head>
	<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta HTTP-EQUIV="pragma" CONTENT="no-cache"> 
<meta HTTP-EQUIV="Cache-Control" CONTENT="no-cache, must-revalidate"> 
<meta HTTP-EQUIV="expires" CONTENT="0"> 
<title>[æ­»ç£•Spring]--IoCä¹‹Spring ç»Ÿä¸€èµ„æºåŠ è½½ç­–ç•¥ | Eucaly</title>	

<link rel="stylesheet" href="https://xinrong2019.github.io//styles/main.css">
<script type="text/javascript">
function getCSS()
{
        datetoday = new Date();
        timenow=datetoday.getTime();
        datetoday.setTime(timenow);
        thehour = datetoday.getHours();

            display = "https://xinrong2019.github.io//media/css/night.css";

            display = "https://xinrong2019.github.io//media/css/night.css";   
      
            display = "https://xinrong2019.github.io//media/css/day.css";

            display = "https://xinrong2019.github.io//media/css/day.css";
      

var css = '<';
        css+='link rel="stylesheet" href='+display+' \/';
        css+='>';
        document.write(css);
}
</script>
<link href="https://fonts.googleapis.com/css?family=Dancing+Script|Noto+Sans+SC:300|Montserrat&display=swap" rel="stylesheet">
<link href="https://at.alicdn.com/t/font_1306644_jwtuc2zzbrd.css" rel="stylesheet" />
<link href="https://at.alicdn.com/t/font_1651848_tf0hnpbyjfj.css" rel="stylesheet" />
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<script type='text/javascript' src='https://xinrong2019.github.io//media/scripts/script.js'></script>
<link href="https://cdn.bootcss.com/animate.css/3.5.2/animate.min.css" rel="stylesheet" />
  <script src="https://cdn.bootcss.com/wow/1.1.2/wow.min.js"></script>
  <script src="https://cdn.bootcss.com/highlight.js/9.15.8/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <script>wow=new WOW({boxClass:'wow',animateClass:'animated',offset:0,mobile:true,live:true});wow.init();</script>

<script type="text/javascript">
window.onload=getCSS();
</script>


</head>

<body class="post-template-default single single-post postid-70 single-format-standard">
	<div id="wrapper">
				<header id="header" class="site-header" 
			style="background-image: linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2)),url(http://static.iocoder.cn/143162657d5f8c7cb7712d0996bf2a38)"
			>
			<div class="site-branding">
				<h1 class="site-title">
					<div class="post-title-name">
						<a href="https://xinrong2019.github.io/" rel="home">[æ­»ç£•Spring]--IoCä¹‹Spring ç»Ÿä¸€èµ„æºåŠ è½½ç­–ç•¥</a>
					</div>
				</h1>
				<h2 class="site-description">Time waits for no one.</h2>
			</div>
			<nav id="nav-wrapper">
				<div class="container">
					<div class="nav-toggle">
						<div class="bars">
							<div class="bar"></div>
							<div class="bar"></div>
							<div class="bar"></div>
						</div>
					</div>
					<div class="clear"></div>
					<ul id="" class="dove">
						

						<li>

							<a href="/"> é¦–é¡µ</a></li>

						

						<li>

							<a href="/archives"> å½’æ¡£</a></li>

						

						<li>

							<a href="/tags"> æ ‡ç­¾</a></li>

						

						<li>

							<a href="/friends"> å‹é“¾</a></li>

						

						<li>

							<a href="/post/mysql"> MySQL</a></li>

						

						<li>

							<a href="/post/dubbo"> Dubbo</a></li>

						

						<li>

							<a href="/post/mq"> MQ</a></li>

						

						<li>

							<a href="/post/spring"> Spring</a></li>

						

						<li>

							<a href="/post/about"> å…³äº</a></li>

						

					</ul>
					</li>

					</ul>
				</div>
			</nav>

			<div class="jingge">
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
			</div>
			<form id="gridea-search-form" data-update="1586601738173" action="/search/index.html">
				<div class="search-box">
					<input class="search-txt" name="q" placeholder="Type to search" />
					<a class="search-btn">
						<i class="iconfont icon-search1" action="/search/index.html"></i>
					</a>
				</div>
			</form>
		</header>
		<div id="content" class="container">
			<div class="row">
				<div class="col-md-8 site-main">
					<article id="post-70"
						class="post-70 post type-post status-publish format-standard hentry category-5 tag-10 tag-9 tag-11">
						<div class="entry-content">
							<div class="entry-meta">
								<div class="entry-info">
									<time>
										2020-01-10
									</time>
									<span>
										26 min read
									</span>
								</div>
							</div>
							<div class="wow slideInLeft entry-summary song">
								<p>åœ¨å­¦ Java SE çš„æ—¶å€™ï¼Œæˆ‘ä»¬å­¦ä¹ äº†ä¸€ä¸ªæ ‡å‡†ç±» java.net.URLï¼Œè¯¥ç±»åœ¨ Java SE ä¸­çš„å®šä½ä¸ºç»Ÿä¸€èµ„æºå®šä½å™¨ï¼ˆUniform Resource Locatorï¼‰ï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“å®ƒçš„å®ç°åŸºæœ¬åªé™äºç½‘ç»œå½¢å¼å‘å¸ƒçš„èµ„æºçš„æŸ¥æ‰¾å’Œå®šä½ã€‚ç„¶è€Œï¼Œå®é™…ä¸Šèµ„æºçš„å®šä¹‰æ¯”è¾ƒå¹¿æ³›ï¼Œé™¤äº†ç½‘ç»œå½¢å¼çš„èµ„æºï¼Œè¿˜æœ‰ä»¥äºŒè¿›åˆ¶å½¢å¼å­˜åœ¨çš„ã€ä»¥æ–‡ä»¶å½¢å¼å­˜åœ¨çš„ã€ä»¥å­—èŠ‚æµå½¢å¼å­˜åœ¨çš„ç­‰ç­‰ã€‚è€Œä¸”å®ƒå¯ä»¥å­˜åœ¨äºä»»ä½•åœºæ‰€ï¼Œæ¯”å¦‚ç½‘ç»œã€æ–‡ä»¶ç³»ç»Ÿã€åº”ç”¨ç¨‹åºä¸­ã€‚æ‰€ä»¥ java.net.URL çš„å±€é™æ€§è¿«ä½¿ Spring å¿…é¡»å®ç°è‡ªå·±çš„èµ„æºåŠ è½½ç­–ç•¥ï¼Œè¯¥èµ„æºåŠ è½½ç­–ç•¥éœ€è¦æ»¡è¶³å¦‚ä¸‹è¦æ±‚ï¼š</p>
<ol>
<li>èŒèƒ½åˆ’åˆ†æ¸…æ¥šã€‚èµ„æºçš„å®šä¹‰å’Œèµ„æºçš„åŠ è½½åº”è¯¥è¦æœ‰ä¸€ä¸ªæ¸…æ™°çš„ç•Œé™ï¼›</li>
<li>ç»Ÿä¸€çš„æŠ½è±¡ã€‚ç»Ÿä¸€çš„èµ„æºå®šä¹‰å’Œèµ„æºåŠ è½½ç­–ç•¥ã€‚èµ„æºåŠ è½½åè¦è¿”å›ç»Ÿä¸€çš„æŠ½è±¡ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯è¦å¯¹èµ„æºè¿›è¡Œæ€æ ·çš„å¤„ç†ï¼Œåº”è¯¥ç”±æŠ½è±¡èµ„æºæ¥å£æ¥ç•Œå®šã€‚</li>
</ol>
<h1 id="1-ç»Ÿä¸€èµ„æºresource">1. ç»Ÿä¸€èµ„æºï¼šResource</h1>
<p><code>org.springframework.core.io.Resource</code> ä¸º Spring æ¡†æ¶æ‰€æœ‰èµ„æºçš„æŠ½è±¡å’Œè®¿é—®æ¥å£ï¼Œå®ƒç»§æ‰¿ <code>org.springframework.core.io.InputStreamSource</code>æ¥å£ã€‚ä½œä¸ºæ‰€æœ‰èµ„æºçš„ç»Ÿä¸€æŠ½è±¡ï¼ŒResource å®šä¹‰äº†ä¸€äº›é€šç”¨çš„æ–¹æ³•ï¼Œç”±å­ç±» <code>AbstractResource</code> æä¾›ç»Ÿä¸€çš„é»˜è®¤å®ç°ã€‚å®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre><code class="language-java">public interface Resource extends InputStreamSource {

	/**
	 * èµ„æºæ˜¯å¦å­˜åœ¨
	 */
	boolean exists();

	/**
	 * èµ„æºæ˜¯å¦å¯è¯»
	 */
	default boolean isReadable() {
		return true;
	}

	/**
	 * èµ„æºæ‰€ä»£è¡¨çš„å¥æŸ„æ˜¯å¦è¢«ä¸€ä¸ª stream æ‰“å¼€äº†
	 */
	default boolean isOpen() {
		return false;
	}

	/**
	 * æ˜¯å¦ä¸º File
	 */
	default boolean isFile() {
		return false;
	}

	/**
	 * è¿”å›èµ„æºçš„ URL çš„å¥æŸ„
	 */
	URL getURL() throws IOException;

	/**
	 * è¿”å›èµ„æºçš„ URI çš„å¥æŸ„
	 */
	URI getURI() throws IOException;

	/**
	 * è¿”å›èµ„æºçš„ File çš„å¥æŸ„
	 */
	File getFile() throws IOException;

	/**
	 * è¿”å› ReadableByteChannel
	 */
	default ReadableByteChannel readableChannel() throws IOException {
		return java.nio.channels.Channels.newChannel(getInputStream());
	}

	/**
	 * èµ„æºå†…å®¹çš„é•¿åº¦
	 */
	long contentLength() throws IOException;

	/**
	 * èµ„æºæœ€åçš„ä¿®æ”¹æ—¶é—´
	 */
	long lastModified() throws IOException;

	/**
	 * æ ¹æ®èµ„æºçš„ç›¸å¯¹è·¯å¾„åˆ›å»ºæ–°èµ„æº
	 */
	Resource createRelative(String relativePath) throws IOException;

	/**
	 * èµ„æºçš„æ–‡ä»¶å
	 */
	@Nullable
	String getFilename();

	/**
	 * èµ„æºçš„æè¿°
	 */
	String getDescription();

}
</code></pre>
<h2 id="11-å­ç±»ç»“æ„">1.1 å­ç±»ç»“æ„</h2>
<p>ç±»ç»“æ„å›¾å¦‚ä¸‹ï¼š<br>
<img src="http://static.iocoder.cn/143162657d5f8c7cb7712d0996bf2a38" alt="Resource ç±»å›¾" loading="lazy"></p>
<p>ä»ä¸Šå›¾å¯ä»¥çœ‹åˆ°ï¼ŒResource æ ¹æ®èµ„æºçš„ä¸åŒç±»å‹æä¾›ä¸åŒçš„å…·ä½“å®ç°ï¼Œå¦‚ä¸‹ï¼š</p>
<ul>
<li>FileSystemResource ï¼šå¯¹ <code>java.io.File</code> ç±»å‹èµ„æºçš„å°è£…ï¼Œåªè¦æ˜¯è·Ÿ File æ‰“äº¤é“çš„ï¼ŒåŸºæœ¬ä¸Šä¸FileSystemResource ä¹Ÿå¯ä»¥æ‰“äº¤é“ã€‚æ”¯æŒæ–‡ä»¶å’Œ URL çš„å½¢å¼ï¼Œå®ç° WritableResource æ¥å£ï¼Œä¸”ä» Spring Framework 5.0 å¼€å§‹ï¼ŒFileSystemResource ä½¿ç”¨ NIO2 APIè¿›è¡Œè¯»/å†™äº¤äº’ã€‚</li>
<li>ByteArrayResource ï¼šå¯¹å­—èŠ‚æ•°ç»„æä¾›çš„æ•°æ®çš„å°è£…ã€‚å¦‚æœé€šè¿‡ InputStream å½¢å¼è®¿é—®è¯¥ç±»å‹çš„èµ„æºï¼Œè¯¥å®ç°ä¼šæ ¹æ®å­—èŠ‚æ•°ç»„çš„æ•°æ®æ„é€ ä¸€ä¸ªç›¸åº”çš„ ByteArrayInputStreamã€‚</li>
<li>UrlResource ï¼šå¯¹ <code>java.net.URL</code>ç±»å‹èµ„æºçš„å°è£…ã€‚å†…éƒ¨å§”æ´¾ URL è¿›è¡Œå…·ä½“çš„èµ„æºæ“ä½œã€‚</li>
<li>ClassPathResource ï¼šclass path ç±»å‹èµ„æºçš„å®ç°ã€‚ä½¿ç”¨ç»™å®šçš„ ClassLoader æˆ–è€…ç»™å®šçš„ Class æ¥åŠ è½½èµ„æºã€‚</li>
<li>InputStreamResource ï¼šå°†ç»™å®šçš„ InputStream ä½œä¸ºä¸€ç§èµ„æºçš„ Resource çš„å®ç°ç±»ã€‚</li>
</ul>
<h2 id="12-abstractresource">1.2 AbstractResource</h2>
<p><code>org.springframework.core.io.AbstractResource</code> ï¼Œä¸º Resource æ¥å£çš„é»˜è®¤æŠ½è±¡å®ç°ã€‚å®ƒå®ç°äº† Resource æ¥å£çš„å¤§éƒ¨åˆ†çš„å…¬å…±å®ç°ï¼Œä½œä¸º Resource æ¥å£ä¸­çš„é‡ä¸­ä¹‹é‡ï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre><code class="language-java">public abstract class AbstractResource implements Resource {

	/**
	 * åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œè‹¥åˆ¤æ–­è¿‡ç¨‹äº§ç”Ÿå¼‚å¸¸ï¼ˆå› ä¸ºä¼šè°ƒç”¨SecurityManageræ¥åˆ¤æ–­ï¼‰ï¼Œå°±å…³é—­å¯¹åº”çš„æµ
	 */
	@Override
	public boolean exists() {
		try {
		  // åŸºäº File è¿›è¡Œåˆ¤æ–­
			return getFile().exists();
		}
		catch (IOException ex) {
			// Fall back to stream existence: can we open the stream?
			// åŸºäº InputStream è¿›è¡Œåˆ¤æ–­
			try {
				InputStream is = getInputStream();
				is.close();
				return true;
			} catch (Throwable isEx) {
				return false;
			}
		}
	}

	/**
	 * ç›´æ¥è¿”å›trueï¼Œè¡¨ç¤ºå¯è¯»
	 */
	@Override
	public boolean isReadable() {
		return true;
	}

	/**
	 * ç›´æ¥è¿”å› falseï¼Œè¡¨ç¤ºæœªè¢«æ‰“å¼€
	 */
	@Override
	public boolean isOpen() {
		return false;
	}

	/**
	 * ç›´æ¥è¿”å›falseï¼Œè¡¨ç¤ºä¸ä¸º File
	 */
	@Override
	public boolean isFile() {
		return false;
	}

	/**
	 * æŠ›å‡º FileNotFoundException å¼‚å¸¸ï¼Œäº¤ç»™å­ç±»å®ç°
	 */
	@Override
	public URL getURL() throws IOException {
		throw new FileNotFoundException(getDescription() + &quot; cannot be resolved to URL&quot;);

	}

	/**
	 * åŸºäº getURL() è¿”å›çš„ URL æ„å»º URI
	 */
	@Override
	public URI getURI() throws IOException {
		URL url = getURL();
		try {
			return ResourceUtils.toURI(url);
		} catch (URISyntaxException ex) {
			throw new NestedIOException(&quot;Invalid URI [&quot; + url + &quot;]&quot;, ex);
		}
	}

	/**
	 * æŠ›å‡º FileNotFoundException å¼‚å¸¸ï¼Œäº¤ç»™å­ç±»å®ç°
	 */
	@Override
	public File getFile() throws IOException {
		throw new FileNotFoundException(getDescription() + &quot; cannot be resolved to absolute file path&quot;);
	}

	/**
	 * æ ¹æ® getInputStream() çš„è¿”å›ç»“æœæ„å»º ReadableByteChannel
	 */
	@Override
	public ReadableByteChannel readableChannel() throws IOException {
		return Channels.newChannel(getInputStream());
	}

	/**
	 * è·å–èµ„æºçš„é•¿åº¦
	 *
	 * è¿™ä¸ªèµ„æºå†…å®¹é•¿åº¦å®é™…å°±æ˜¯èµ„æºçš„å­—èŠ‚é•¿åº¦ï¼Œé€šè¿‡å…¨éƒ¨è¯»å–ä¸€éæ¥åˆ¤æ–­
	 */
	@Override
	public long contentLength() throws IOException {
		InputStream is = getInputStream();
		try {
			long size = 0;
			byte[] buf = new byte[255]; // æ¯æ¬¡æœ€å¤šè¯»å– 255 å­—èŠ‚
			int read;
			while ((read = is.read(buf)) != -1) {
				size += read;
			}
			return size;
		} finally {
			try {
				is.close();
			} catch (IOException ex) {
			}
		}
	}

	/**
	 * è¿”å›èµ„æºæœ€åçš„ä¿®æ”¹æ—¶é—´
	 */
	@Override
	public long lastModified() throws IOException {
		long lastModified = getFileForLastModifiedCheck().lastModified();
		if (lastModified == 0L) {
			throw new FileNotFoundException(getDescription() +
					&quot; cannot be resolved in the file system for resolving its last-modified timestamp&quot;);
		}
		return lastModified;
	}

	protected File getFileForLastModifiedCheck() throws IOException {
		return getFile();
	}

	/**
	 * æŠ›å‡º FileNotFoundException å¼‚å¸¸ï¼Œäº¤ç»™å­ç±»å®ç°
	 */
	@Override
	public Resource createRelative(String relativePath) throws IOException {
		throw new FileNotFoundException(&quot;Cannot create a relative resource for &quot; + getDescription());
	}

	/**
	 * è·å–èµ„æºåç§°ï¼Œé»˜è®¤è¿”å› null ï¼Œäº¤ç»™å­ç±»å®ç°
	 */
	@Override
	@Nullable
	public String getFilename() {
		return null;
	}

	/**
	 * è¿”å›èµ„æºçš„æè¿°
	 */
	@Override
	public String toString() {
		return getDescription();
	}

	@Override
	public boolean equals(Object obj) {
		return (obj == this ||
			(obj instanceof Resource &amp;&amp; ((Resource) obj).getDescription().equals(getDescription())));
	}

	@Override
	public int hashCode() {
		return getDescription().hashCode();
	}

}
</code></pre>
<p>å¦‚æœæˆ‘ä»¬æƒ³è¦å®ç°è‡ªå®šä¹‰çš„ Resource ï¼Œè®°ä½ä¸è¦å®ç° Resource æ¥å£ï¼Œè€Œåº”è¯¥ç»§æ‰¿ AbstractResource æŠ½è±¡ç±»ï¼Œç„¶åæ ¹æ®å½“å‰çš„å…·ä½“èµ„æºç‰¹æ€§è¦†ç›–ç›¸åº”çš„æ–¹æ³•å³å¯ã€‚</p>
<h1 id="2-ç»Ÿä¸€èµ„æºå®šä½resourceloader">2. ç»Ÿä¸€èµ„æºå®šä½ï¼šResourceLoader</h1>
<p>ä¸€å¼€å§‹å°±è¯´äº† Spring å°†èµ„æºçš„å®šä¹‰å’Œèµ„æºçš„åŠ è½½åŒºåˆ†å¼€äº†ï¼ŒResource å®šä¹‰äº†ç»Ÿä¸€çš„èµ„æºï¼Œ<strong>é‚£èµ„æºçš„åŠ è½½åˆ™ç”± ResourceLoader æ¥ç»Ÿä¸€å®šä¹‰</strong>ã€‚</p>
<p><code>org.springframework.core.io.ResourceLoader</code>ä¸º Spring èµ„æºåŠ è½½çš„ç»Ÿä¸€æŠ½è±¡ï¼Œå…·ä½“çš„èµ„æºåŠ è½½åˆ™ç”±ç›¸åº”çš„å®ç°ç±»æ¥å®Œæˆï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°† ResourceLoader ç§°ä½œä¸ºç»Ÿä¸€èµ„æºå®šä½å™¨ã€‚å…¶å®šä¹‰å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>FROM ã€ŠSpring æºç æ·±åº¦è§£æã€‹P16 é¡µ<br>
ResourceLoaderï¼Œå®šä¹‰èµ„æºåŠ è½½å™¨ï¼Œä¸»è¦åº”ç”¨äºæ ¹æ®ç»™å®šçš„èµ„æºæ–‡ä»¶åœ°å€ï¼Œè¿”å›å¯¹åº”çš„ Resource ã€‚</p>
</blockquote>
<pre><code class="language-java">public interface ResourceLoader {

	String CLASSPATH_URL_PREFIX = ResourceUtils.CLASSPATH_URL_PREFIX; // CLASSPATH URL å‰ç¼€ã€‚é»˜è®¤ä¸ºï¼š&quot;classpath:&quot;

	Resource getResource(String location);

	ClassLoader getClassLoader();

}
</code></pre>
<ul>
<li><code>#getResource(String location)</code> æ–¹æ³•ï¼Œæ ¹æ®æ‰€æä¾›èµ„æºçš„è·¯å¾„ location è¿”å› Resource å®ä¾‹ï¼Œä½†æ˜¯å®ƒä¸ç¡®ä¿è¯¥ Resource ä¸€å®šå­˜åœ¨ï¼Œéœ€è¦è°ƒç”¨ <code>Resource#exist()</code>æ–¹æ³•æ¥åˆ¤æ–­ã€‚
<ul>
<li>è¯¥æ–¹æ³•æ”¯æŒä»¥ä¸‹æ¨¡å¼çš„èµ„æºåŠ è½½ï¼š
<ul>
<li>URLä½ç½®èµ„æºï¼Œå¦‚ <code>&quot;file:C:/test.dat&quot;</code>ã€‚</li>
<li>ClassPathä½ç½®èµ„æºï¼Œå¦‚<code>&quot;classpath:test.dat</code> ã€‚</li>
<li>ç›¸å¯¹è·¯å¾„èµ„æºï¼Œå¦‚<code>&quot;WEB-INF/test.dat&quot;</code> ï¼Œæ­¤æ—¶è¿”å›çš„Resource å®ä¾‹ï¼Œæ ¹æ®å®ç°ä¸åŒè€Œä¸åŒã€‚</li>
</ul>
</li>
<li>è¯¥æ–¹æ³•çš„ä¸»è¦å®ç°æ˜¯åœ¨å…¶å­ç±» <code>DefaultResourceLoader</code>ä¸­å®ç°ï¼Œå…·ä½“è¿‡ç¨‹æˆ‘ä»¬åœ¨åˆ†æ DefaultResourceLoader æ—¶åšè¯¦ç»†è¯´æ˜ã€‚</li>
</ul>
</li>
<li><code>#getClassLoader()</code>æ–¹æ³•ï¼Œè¿”å› ClassLoader å®ä¾‹ï¼Œå¯¹äºæƒ³è¦è·å– ResourceLoader ä½¿ç”¨çš„ ClassLoader ç”¨æˆ·æ¥è¯´ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨è¯¥æ–¹æ³•æ¥è·å–ã€‚åœ¨åˆ†æ Resource æ—¶ï¼Œæåˆ°äº†ä¸€ä¸ªç±» ClassPathResource ï¼Œè¿™ä¸ªç±»æ˜¯å¯ä»¥æ ¹æ®æŒ‡å®šçš„ ClassLoader æ¥åŠ è½½èµ„æºçš„ã€‚</li>
</ul>
<h2 id="21-å­ç±»ç»“æ„">2.1 å­ç±»ç»“æ„</h2>
<p>ä½œä¸º Spring ç»Ÿä¸€çš„èµ„æºåŠ è½½å™¨ï¼Œå®ƒæä¾›äº†ç»Ÿä¸€çš„æŠ½è±¡ï¼Œå…·ä½“çš„å®ç°åˆ™ç”±ç›¸åº”çš„å­ç±»æ¥è´Ÿè´£å®ç°ï¼Œå…¶ç±»çš„ç±»ç»“æ„å›¾å¦‚ä¸‹ï¼š<br>
<img src="http://static.iocoder.cn/2446cc9fba90605b691ea250cf340ebb" alt="ResourceLoader ç±»å›¾" loading="lazy"></p>
<h2 id="22-defaultresourceloader">2.2 DefaultResourceLoader</h2>
<p>ä¸ AbstractResource ç›¸ä¼¼ï¼Œ<code>org.springframework.core.io.DefaultResourceLoader</code>æ˜¯ ResourceLoader çš„é»˜è®¤å®ç°ã€‚</p>
<h3 id="221-æ„é€ å‡½æ•°">2.2.1 æ„é€ å‡½æ•°</h3>
<p>å®ƒæ¥æ”¶ ClassLoader ä½œä¸ºæ„é€ å‡½æ•°çš„å‚æ•°ï¼Œæˆ–è€…ä½¿ç”¨ä¸å¸¦å‚æ•°çš„æ„é€ å‡½æ•°ã€‚</p>
<ul>
<li>åœ¨ä½¿ç”¨ä¸å¸¦å‚æ•°çš„æ„é€ å‡½æ•°æ—¶ï¼Œä½¿ç”¨çš„ ClassLoader ä¸ºé»˜è®¤çš„ ClassLoaderï¼ˆä¸€èˆ¬ Thread.currentThread()#getContextClassLoader() ï¼‰ã€‚</li>
<li>åœ¨ä½¿ç”¨å¸¦å‚æ•°çš„æ„é€ å‡½æ•°æ—¶ï¼Œå¯ä»¥é€šè¿‡ ClassUtils#getDefaultClassLoader()è·å–ã€‚</li>
</ul>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-java">@Nullable
private ClassLoader classLoader;

public DefaultResourceLoader() { // æ— å‚æ„é€ å‡½æ•°
	this.classLoader = ClassUtils.getDefaultClassLoader();
}

public DefaultResourceLoader(@Nullable ClassLoader classLoader) { // å¸¦ ClassLoader å‚æ•°çš„æ„é€ å‡½æ•°
	this.classLoader = classLoader;
}

public void setClassLoader(@Nullable ClassLoader classLoader) {
	this.classLoader = classLoader;
}

@Override
@Nullable
public ClassLoader getClassLoader() {
	return (this.classLoader != null ? this.classLoader : ClassUtils.getDefaultClassLoader());
}
</code></pre>
<ul>
<li>å¦å¤–ï¼Œä¹Ÿå¯ä»¥è°ƒç”¨ #setClassLoader() æ–¹æ³•è¿›è¡Œåç»­è®¾ç½®ã€‚</li>
</ul>
<h3 id="222-getresource-æ–¹æ³•">2.2.2 getResource æ–¹æ³•</h3>
<p>ResourceLoader ä¸­æœ€æ ¸å¿ƒçš„æ–¹æ³•ä¸º <code>#getResource(String location)</code>ï¼Œå®ƒæ ¹æ®æä¾›çš„ location è¿”å›ç›¸åº”çš„ Resource ã€‚è€Œ DefaultResourceLoader å¯¹è¯¥æ–¹æ³•æä¾›äº†<strong>æ ¸å¿ƒå®ç°</strong>ï¼ˆå› ä¸ºï¼Œå®ƒçš„ä¸¤ä¸ªå­ç±»éƒ½æ²¡æœ‰æä¾›è¦†ç›–è¯¥æ–¹æ³•ï¼Œæ‰€ä»¥å¯ä»¥æ–­å®š ResourceLoader çš„èµ„æºåŠ è½½ç­–ç•¥å°±å°è£…åœ¨ DefaultResourceLoader ä¸­)ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-java">// DefaultResourceLoader.java

@Override
public Resource getResource(String location) {
    Assert.notNull(location, &quot;Location must not be null&quot;);

    // é¦–å…ˆï¼Œé€šè¿‡ ProtocolResolver æ¥åŠ è½½èµ„æº
    for (ProtocolResolver protocolResolver : this.protocolResolvers) {
        Resource resource = protocolResolver.resolve(location, this);
        if (resource != null) {
            return resource;
        }
    }
    // å…¶æ¬¡ï¼Œä»¥ / å¼€å¤´ï¼Œè¿”å› ClassPathContextResource ç±»å‹çš„èµ„æº
    if (location.startsWith(&quot;/&quot;)) {
        return getResourceByPath(location);
    // å†æ¬¡ï¼Œä»¥ classpath: å¼€å¤´ï¼Œè¿”å› ClassPathResource ç±»å‹çš„èµ„æº
    } else if (location.startsWith(CLASSPATH_URL_PREFIX)) {
        return new ClassPathResource(location.substring(CLASSPATH_URL_PREFIX.length()), getClassLoader());
    // ç„¶åï¼Œæ ¹æ®æ˜¯å¦ä¸ºæ–‡ä»¶ URL ï¼Œæ˜¯åˆ™è¿”å› FileUrlResource ç±»å‹çš„èµ„æºï¼Œå¦åˆ™è¿”å› UrlResource ç±»å‹çš„èµ„æº
    } else {
        try {
            // Try to parse the location as a URL...
            URL url = new URL(location);
            return (ResourceUtils.isFileURL(url) ? new FileUrlResource(url) : new UrlResource(url));
        } catch (MalformedURLException ex) {
            // æœ€åï¼Œè¿”å› ClassPathContextResource ç±»å‹çš„èµ„æº
            // No URL -&gt; resolve as resource path.
            return getResourceByPath(location);
        }
    }
}
</code></pre>
<ul>
<li>é¦–å…ˆï¼Œé€šè¿‡ ProtocolResolver æ¥åŠ è½½èµ„æºï¼ŒæˆåŠŸè¿”å› Resource ã€‚</li>
<li>å…¶æ¬¡ï¼Œè‹¥<code>location</code> ä»¥ <code>&quot;/&quot;</code> å¼€å¤´ï¼Œåˆ™è°ƒç”¨ <code>#getResourceByPath()</code>æ–¹æ³•ï¼Œæ„é€  ClassPathContextResource ç±»å‹èµ„æºå¹¶è¿”å›ã€‚ä»£ç å¦‚ä¸‹ï¼š</li>
</ul>
<pre><code class="language-java">protected Resource getResourceByPath(String path) {
	return new ClassPathContextResource(path, getClassLoader());
}
</code></pre>
<ul>
<li>å†æ¬¡ï¼Œè‹¥<code>location</code> ä»¥ <code>&quot;classpath:&quot;</code> å¼€å¤´ï¼Œåˆ™æ„é€  ClassPathResource ç±»å‹èµ„æºå¹¶è¿”å›ã€‚åœ¨æ„é€ è¯¥èµ„æºæ—¶ï¼Œé€šè¿‡ <code>#getClassLoader()</code> è·å–å½“å‰çš„ ClassLoaderã€‚</li>
<li>ç„¶åï¼Œæ„é€  URL ï¼Œå°è¯•é€šè¿‡å®ƒè¿›è¡Œèµ„æºå®šä½ï¼Œè‹¥æ²¡æœ‰æŠ›å‡º MalformedURLException å¼‚å¸¸ï¼Œåˆ™åˆ¤æ–­æ˜¯å¦ä¸º FileURL , å¦‚æœæ˜¯åˆ™æ„é€  FileUrlResource ç±»å‹çš„èµ„æºï¼Œå¦åˆ™æ„é€  UrlResource ç±»å‹çš„èµ„æºã€‚</li>
<li>æœ€åï¼Œè‹¥åœ¨åŠ è½½è¿‡ç¨‹ä¸­æŠ›å‡º MalformedURLException å¼‚å¸¸ï¼Œåˆ™å§”æ´¾ #getResourceByPath() æ–¹æ³•ï¼Œå®ç°èµ„æºå®šä½åŠ è½½ã€‚ğŸ˜ˆ å®é™…ä¸Šï¼Œå’Œã€å…¶æ¬¡ã€‘ç›¸åŒã€‚</li>
</ul>
<h3 id="223-protocolresolver">2.2.3 ProtocolResolver</h3>
<p><code>org.springframework.core.io.ProtocolResolver</code>ï¼Œç”¨æˆ·è‡ªå®šä¹‰åè®®èµ„æºè§£å†³ç­–ç•¥ï¼Œä½œä¸º DefaultResourceLoader çš„ <strong>SPI</strong>ï¼šå®ƒå…è®¸ç”¨æˆ·è‡ªå®šä¹‰èµ„æºåŠ è½½åè®®ï¼Œè€Œä¸éœ€è¦ç»§æ‰¿ ResourceLoader çš„å­ç±»ã€‚<br>
åœ¨ä»‹ç» Resource æ—¶ï¼Œæåˆ°å¦‚æœè¦å®ç°è‡ªå®šä¹‰ Resourceï¼Œæˆ‘ä»¬åªéœ€è¦ç»§æ‰¿ AbstractResource å³å¯ï¼Œä½†æ˜¯æœ‰äº† ProtocolResolver åï¼Œæˆ‘ä»¬ä¸éœ€è¦ç›´æ¥ç»§æ‰¿ DefaultResourceLoaderï¼Œæ”¹ä¸ºå®ç° ProtocolResolver æ¥å£ä¹Ÿå¯ä»¥å®ç°è‡ªå®šä¹‰çš„ ResourceLoaderã€‚</p>
<p>ProtocolResolver æ¥å£ï¼Œä»…æœ‰ä¸€ä¸ªæ–¹æ³•<code>Resource resolve(String location, ResourceLoader resourceLoader)</code>ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-java">/**
 * ä½¿ç”¨æŒ‡å®šçš„ ResourceLoader ï¼Œè§£ææŒ‡å®šçš„ location ã€‚
 * è‹¥æˆåŠŸï¼Œåˆ™è¿”å›å¯¹åº”çš„ Resource ã€‚
 *
 * Resolve the given location against the given resource loader
 * if this implementation's protocol matches.
 * @param location the user-specified resource location èµ„æºè·¯å¾„
 * @param resourceLoader the associated resource loader æŒ‡å®šçš„åŠ è½½å™¨ ResourceLoader
 * @return a corresponding {@code Resource} handle if the given location
 * matches this resolver's protocol, or {@code null} otherwise è¿”å›ä¸ºç›¸åº”çš„ Resource
 */
@Nullable
Resource resolve(String location, ResourceLoader resourceLoader);
</code></pre>
<p>åœ¨ Spring ä¸­ä½ ä¼šå‘ç°è¯¥æ¥å£å¹¶æ²¡æœ‰å®ç°ç±»ï¼Œå®ƒéœ€è¦ç”¨æˆ·è‡ªå®šä¹‰ï¼Œè‡ªå®šä¹‰çš„ Resolver å¦‚ä½•åŠ å…¥ Spring ä½“ç³»å‘¢ï¼Ÿè°ƒç”¨ <code>DefaultResourceLoader#addProtocolResolver(ProtocolResolver)</code>æ–¹æ³•å³å¯ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-java">/**
 * ProtocolResolver é›†åˆ
 */
private final Set&lt;ProtocolResolver&gt; protocolResolvers = new LinkedHashSet&lt;&gt;(4);

public void addProtocolResolver(ProtocolResolver resolver) {
	Assert.notNull(resolver, &quot;ProtocolResolver must not be null&quot;);
	this.protocolResolvers.add(resolver);
}
</code></pre>
<h3 id="224-ç¤ºä¾‹">2.2.4 ç¤ºä¾‹</h3>
<p>ä¸‹é¢ç¤ºä¾‹æ˜¯æ¼”ç¤º DefaultResourceLoader åŠ è½½èµ„æºçš„å…·ä½“ç­–ç•¥ï¼Œä»£ç å¦‚ä¸‹ï¼ˆè¯¥ç¤ºä¾‹å‚è€ƒã€ŠSpring æ­ç§˜ã€‹ P89ï¼‰ï¼š</p>
<pre><code class="language-java">ResourceLoader resourceLoader = new DefaultResourceLoader();

Resource fileResource1 = resourceLoader.getResource(&quot;D:/Users/chenming673/Documents/spark.txt&quot;);
System.out.println(&quot;fileResource1 is FileSystemResource:&quot; + (fileResource1 instanceof FileSystemResource));

Resource fileResource2 = resourceLoader.getResource(&quot;/Users/chenming673/Documents/spark.txt&quot;);
System.out.println(&quot;fileResource2 is ClassPathResource:&quot; + (fileResource2 instanceof ClassPathResource));

Resource urlResource1 = resourceLoader.getResource(&quot;file:/Users/chenming673/Documents/spark.txt&quot;);
System.out.println(&quot;urlResource1 is UrlResource:&quot; + (urlResource1 instanceof UrlResource));

Resource urlResource2 = resourceLoader.getResource(&quot;http://www.baidu.com&quot;);
System.out.println(&quot;urlResource1 is urlResource:&quot; + (urlResource2 instanceof  UrlResource));
</code></pre>
<p>è¿è¡Œç»“æœï¼š</p>
<pre><code class="language-java">fileResource1 is FileSystemResource:false
fileResource2 is ClassPathResource:true
urlResource1 is UrlResource:true
urlResource1 is urlResource:true
</code></pre>
<ul>
<li>å…¶å®å¯¹äº<code>fileResource1</code>ï¼Œæˆ‘ä»¬æ›´åŠ å¸Œæœ›æ˜¯ FileSystemResource èµ„æºç±»å‹ã€‚ä½†æ˜¯ï¼Œäº‹ä¸æ„¿è¿ï¼Œå®ƒæ˜¯ ClassPathResource ç±»å‹ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿåœ¨ <code>DefaultResourceLoader#getResource()</code>æ–¹æ³•çš„èµ„æºåŠ è½½ç­–ç•¥ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“ <code>&quot;D:/Users/chenming673/Documents/spark.txt&quot;</code> åœ°å€ï¼Œå…¶å®åœ¨è¯¥æ–¹æ³•ä¸­æ²¡æœ‰ç›¸åº”çš„èµ„æºç±»å‹ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šåœ¨æŠ›å‡º MalformedURLException å¼‚å¸¸æ—¶ï¼Œé€šè¿‡ <code>DefaultResourceLoader#getResourceByPath(...)</code> æ–¹æ³•ï¼Œæ„é€ ä¸€ä¸ª ClassPathResource ç±»å‹çš„èµ„æºã€‚</li>
<li>è€Œ <code>urlResource1</code> å’Œ<code>urlResource2</code>ï¼ŒæŒ‡å®šæœ‰åè®®å‰ç¼€çš„èµ„æºè·¯å¾„ï¼Œåˆ™é€šè¿‡ URL å°±å¯ä»¥å®šä¹‰ï¼Œæ‰€ä»¥è¿”å›çš„éƒ½æ˜¯ UrlResource ç±»å‹ã€‚</li>
</ul>
<h2 id="23-filesystemresourceloader">2.3 FileSystemResourceLoader</h2>
<p>ä»ä¸Šé¢çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬çœ‹åˆ°ï¼Œå…¶å® DefaultResourceLoader å¯¹<code>#getResourceByPath(String)</code>æ–¹æ³•å¤„ç†å…¶å®ä¸æ˜¯å¾ˆæ°å½“ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>org.springframework.core.io.FileSystemResourceLoader</code> ã€‚å®ƒç»§æ‰¿ DefaultResourceLoader ï¼Œä¸”è¦†å†™äº† <code>#getResourceByPath(String)</code>æ–¹æ³•ï¼Œä½¿ä¹‹ä»æ–‡ä»¶ç³»ç»ŸåŠ è½½èµ„æºå¹¶ä»¥ FileSystemResource ç±»å‹è¿”å›ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°æƒ³è¦çš„èµ„æºç±»å‹ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-java">@Override
protected Resource getResourceByPath(String path) {
	// æˆªå–é¦– /
	if (path.startsWith(&quot;/&quot;)) {
		path = path.substring(1);
	}
	// åˆ›å»º FileSystemContextResource ç±»å‹çš„èµ„æº
	return new FileSystemContextResource(path);
}
</code></pre>
<h3 id="231-filesystemcontextresource">2.3.1 FileSystemContextResource</h3>
<p>FileSystemContextResource ï¼Œä¸º FileSystemResourceLoader çš„å†…éƒ¨ç±»ï¼Œå®ƒç»§æ‰¿ FileSystemResource ç±»ï¼Œå®ç° ContextResource æ¥å£ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-java">/**
 * FileSystemResource that explicitly expresses a context-relative path
 * through implementing the ContextResource interface.
 */
private static class FileSystemContextResource extends FileSystemResource implements ContextResource {

	public FileSystemContextResource(String path) {
		super(path);
	}

	@Override
	public String getPathWithinContext() {
		return getPath();
	}
}
</code></pre>
<ul>
<li>åœ¨æ„é€ å™¨ä¸­ï¼Œä¹Ÿæ˜¯è°ƒç”¨ FileSystemResource çš„æ„é€ å‡½æ•°æ¥æ„é€  FileSystemResource çš„ã€‚</li>
<li>ä¸ºä»€ä¹ˆè¦æœ‰ FileSystemContextResource ç±»çš„åŸå› æ˜¯ï¼Œå®ç° ContextResource æ¥å£ï¼Œå¹¶å®ç°å¯¹åº”çš„ <code>#getPathWithinContext()</code>æ¥å£æ–¹æ³•ã€‚</li>
</ul>
<h3 id="232-ç¤ºä¾‹">2.3.2 ç¤ºä¾‹</h3>
<p>åœ¨å›è¿‡å¤´çœ‹ ã€Œ2.2.4 ç¤ºä¾‹ã€ ï¼Œå¦‚æœå°† DefaultResourceLoader æ”¹ä¸º FileSystemResourceLoader ï¼Œåˆ™ fileResource1 åˆ™ä¸º FileSystemResource ç±»å‹çš„èµ„æºã€‚</p>
<h2 id="24-classrelativeresourceloader">2.4 ClassRelativeResourceLoader</h2>
<p><code>org.springframework.core.io.ClassRelativeResourceLoader</code> ï¼Œæ˜¯ DefaultResourceLoader çš„å¦ä¸€ä¸ªå­ç±»çš„å®ç°ã€‚å’Œ FileSystemResourceLoader ç±»ä¼¼ï¼Œåœ¨å®ç°ä»£ç çš„ç»“æ„ä¸Šç±»ä¼¼ï¼Œä¹Ÿæ˜¯è¦†å†™<code>#getResourceByPath(String path)</code>æ–¹æ³•ï¼Œå¹¶è¿”å›å…¶å¯¹åº”çš„ ClassRelativeContextResource çš„èµ„æºç±»å‹ã€‚</p>
<p>æ„Ÿå…´è¶£çš„èƒ–å‹ï¼Œå¯ä»¥çœ‹çœ‹ <a href="https://blog.csdn.net/seasonsbin/article/details/80914911">ã€ŠSpring5ï¼šå°±è¿™ä¸€æ¬¡ï¼Œæå®šèµ„æºåŠ è½½å™¨ä¹‹ClassRelativeResourceLoaderã€‹</a> æ–‡ç« ã€‚</p>
<blockquote>
<p>ClassRelativeResourceLoader æ‰©å±•çš„åŠŸèƒ½æ˜¯ï¼Œå¯ä»¥æ ¹æ®ç»™å®šçš„class æ‰€åœ¨åŒ…æˆ–è€…æ‰€åœ¨åŒ…çš„å­åŒ…ä¸‹åŠ è½½èµ„æºã€‚</p>
</blockquote>
<h2 id="25-resourcepatternresolver">2.5 ResourcePatternResolver</h2>
<p>ResourceLoader çš„ <code>Resource getResource(String location)</code>æ–¹æ³•ï¼Œæ¯æ¬¡åªèƒ½æ ¹æ® location è¿”å›ä¸€ä¸ª Resource ã€‚å½“éœ€è¦åŠ è½½å¤šä¸ªèµ„æºæ—¶ï¼Œæˆ‘ä»¬é™¤äº†å¤šæ¬¡è°ƒç”¨ <code>#getResource(String location)</code> æ–¹æ³•å¤–ï¼Œåˆ«æ— ä»–æ³•ã€‚<code>org.springframework.core.io.support.ResourcePatternResolver</code> æ˜¯ ResourceLoader çš„æ‰©å±•ï¼Œå®ƒæ”¯æŒæ ¹æ®æŒ‡å®šçš„èµ„æºè·¯å¾„åŒ¹é…æ¨¡å¼æ¯æ¬¡è¿”å›å¤šä¸ª Resource å®ä¾‹ï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre><code class="language-java">public interface ResourcePatternResolver extends ResourceLoader {

	String CLASSPATH_ALL_URL_PREFIX = &quot;classpath*:&quot;;

	Resource[] getResources(String locationPattern) throws IOException;

}
</code></pre>
<ul>
<li>ResourcePatternResolver åœ¨ ResourceLoader çš„åŸºç¡€ä¸Šå¢åŠ äº† <code>#getResources(String locationPattern)</code>æ–¹æ³•ï¼Œä»¥æ”¯æŒæ ¹æ®è·¯å¾„åŒ¹é…æ¨¡å¼è¿”å›å¤šä¸ª Resource å®ä¾‹ã€‚</li>
<li>åŒæ—¶ï¼Œä¹Ÿæ–°å¢äº†ä¸€ç§æ–°çš„åè®®å‰ç¼€ <code>&quot;classpath*:&quot;</code>ï¼Œè¯¥åè®®å‰ç¼€ç”±å…¶å­ç±»è´Ÿè´£å®ç°ã€‚</li>
</ul>
<h2 id="26-pathmatchingresourcepatternresolver">2.6 PathMatchingResourcePatternResolver</h2>
<p><code>org.springframework.core.io.support.PathMatchingResourcePatternResolver</code>ï¼Œä¸º ResourcePatternResolver æœ€å¸¸ç”¨çš„å­ç±»ï¼Œå®ƒé™¤äº†æ”¯æŒ ResourceLoader å’Œ ResourcePatternResolver æ–°å¢çš„<code>&quot;classpath*:&quot;</code> å‰ç¼€å¤–ï¼Œè¿˜æ”¯æŒ Ant é£æ ¼çš„è·¯å¾„åŒ¹é…æ¨¡å¼ï¼ˆç±»ä¼¼äº<code>&quot;**/*.xml&quot;</code>ï¼‰ã€‚</p>
<h3 id="261-æ„é€ å‡½æ•°">2.6.1 æ„é€ å‡½æ•°</h3>
<p>PathMatchingResourcePatternResolver æä¾›äº†ä¸‰ä¸ªæ„é€ å‡½æ•°ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="language-java">/**
 * å†…ç½®çš„ ResourceLoader èµ„æºå®šä½å™¨
 */
private final ResourceLoader resourceLoader;
/**
 * Ant è·¯å¾„åŒ¹é…å™¨
 */
private PathMatcher pathMatcher = new AntPathMatcher();

public PathMatchingResourcePatternResolver() {
	this.resourceLoader = new DefaultResourceLoader();
}

public PathMatchingResourcePatternResolver(ResourceLoader resourceLoader) {
	Assert.notNull(resourceLoader, &quot;ResourceLoader must not be null&quot;);
	this.resourceLoader = resourceLoader;
}

public PathMatchingResourcePatternResolver(@Nullable ClassLoader classLoader) {
	this.resourceLoader = new DefaultResourceLoader(classLoader);
}
</code></pre>
<ul>
<li>PathMatchingResourcePatternResolver åœ¨å®ä¾‹åŒ–çš„æ—¶å€™ï¼Œå¯ä»¥æŒ‡å®šä¸€ä¸ª ResourceLoaderï¼Œå¦‚æœä¸æŒ‡å®šçš„è¯ï¼Œå®ƒä¼šåœ¨å†…éƒ¨æ„é€ ä¸€ä¸ª DefaultResourceLoader ã€‚</li>
<li><code>pathMatcher</code> å±æ€§ï¼Œé»˜è®¤ä¸º AntPathMatcher å¯¹è±¡ï¼Œç”¨äºæ”¯æŒ Ant ç±»å‹çš„è·¯å¾„åŒ¹é…ã€‚</li>
</ul>
<h3 id="262-getresource">2.6.2 getResource</h3>
<pre><code class="language-java">@Override
public Resource getResource(String location) {
	return getResourceLoader().getResource(location);
}

public ResourceLoader getResourceLoader() {
	return this.resourceLoader;
}
</code></pre>
<p>è¯¥æ–¹æ³•ï¼Œç›´æ¥å§”æ‰˜ç»™ç›¸åº”çš„ ResourceLoader æ¥å®ç°ã€‚æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬åœ¨å®ä¾‹åŒ–çš„ PathMatchingResourcePatternResolver çš„æ—¶å€™ï¼Œå¦‚æœæœªæŒ‡å®š ResourceLoader å‚æ•°çš„æƒ…å†µä¸‹ï¼Œé‚£ä¹ˆåœ¨åŠ è½½èµ„æºæ—¶ï¼Œå…¶å®å°±æ˜¯ DefaultResourceLoader çš„è¿‡ç¨‹ã€‚</p>
<p>å…¶å®åœ¨ä¸‹é¢ä»‹ç»çš„<code>Resource[] getResources(String locationPattern)</code> æ–¹æ³•ä¹Ÿç›¸åŒï¼Œåªä¸è¿‡è¿”å›çš„èµ„æºæ˜¯å¤šä¸ªè€Œå·²ã€‚</p>
<h3 id="263-getresources">2.6.3 getResources</h3>
<pre><code class="language-java">@Override
public Resource[] getResources(String locationPattern) throws IOException {
    Assert.notNull(locationPattern, &quot;Location pattern must not be null&quot;);
    // ä»¥ &quot;classpath*:&quot; å¼€å¤´
    if (locationPattern.startsWith(CLASSPATH_ALL_URL_PREFIX)) {
        // è·¯å¾„åŒ…å«é€šé…ç¬¦
        // a class path resource (multiple resources for same name possible)
        if (getPathMatcher().isPattern(locationPattern.substring(CLASSPATH_ALL_URL_PREFIX.length()))) {
            // a class path resource pattern
            return findPathMatchingResources(locationPattern);
        // è·¯å¾„ä¸åŒ…å«é€šé…ç¬¦
        } else {
            // all class path resources with the given name
            return findAllClassPathResources(locationPattern.substring(CLASSPATH_ALL_URL_PREFIX.length()));
        }
    // ä¸ä»¥ &quot;classpath*:&quot; å¼€å¤´
    } else {
        // Generally only look for a pattern after a prefix here, // é€šå¸¸åªåœ¨è¿™é‡Œçš„å‰ç¼€åé¢æŸ¥æ‰¾æ¨¡å¼
        // and on Tomcat only after the &quot;*/&quot; separator for its &quot;war:&quot; protocol. è€Œåœ¨ Tomcat ä¸Šåªæœ‰åœ¨ â€œ*/ â€åˆ†éš”ç¬¦ä¹‹åæ‰ä¸ºå…¶ â€œwar:â€ åè®®
        int prefixEnd = (locationPattern.startsWith(&quot;war:&quot;) ? locationPattern.indexOf(&quot;*/&quot;) + 1 :
                locationPattern.indexOf(':') + 1);
        // è·¯å¾„åŒ…å«é€šé…ç¬¦
        if (getPathMatcher().isPattern(locationPattern.substring(prefixEnd))) {
            // a file pattern
            return findPathMatchingResources(locationPattern);
        // è·¯å¾„ä¸åŒ…å«é€šé…ç¬¦
        } else {
            // a single resource with the given name
            return new Resource[] {getResourceLoader().getResource(locationPattern)};
        }
    }
}
</code></pre>
<p>é€»è¾‘å¤„ç†å¦‚ä¸‹å›¾ï¼š<br>
<img src="https://gitee.com/jinxin.70/oss/raw/master/uPic/8LCTWU_2020_1_11_14_10_11.png" alt="" loading="lazy"></p>
<ul>
<li>é <code>&quot;classpath*:&quot;</code>å¼€å¤´ï¼Œä¸”è·¯å¾„ä¸åŒ…å«é€šé…ç¬¦ï¼Œç›´æ¥å§”æ‰˜ç»™ç›¸åº”çš„ ResourceLoader æ¥å®ç°ã€‚</li>
<li>å…¶ä»–æƒ…å†µï¼Œè°ƒç”¨<code>#findAllClassPathResources(...)</code>ã€æˆ– <code>#findPathMatchingResources(...)</code> æ–¹æ³•ï¼Œè¿”å›å¤šä¸ª Resource ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥è¯¦ç»†åˆ†æã€‚</li>
</ul>
<h3 id="264-findallclasspathresources">2.6.4 findAllClassPathResources</h3>
<p>å½“<code>locationPattern</code> ä»¥<code>&quot;classpath*:&quot;</code> å¼€å¤´ä½†æ˜¯ä¸åŒ…å«é€šé…ç¬¦ï¼Œåˆ™è°ƒç”¨ <code>#findAllClassPathResources(...)</code> æ–¹æ³•åŠ è½½èµ„æºã€‚è¯¥æ–¹æ³•è¿”å› classes è·¯å¾„ä¸‹å’Œæ‰€æœ‰ jar åŒ…ä¸­çš„æ‰€æœ‰ç›¸åŒ¹é…çš„èµ„æºã€‚</p>
<pre><code class="language-java">protected Resource[] findAllClassPathResources(String location) throws IOException {
	String path = location;
	// å»é™¤é¦–ä¸ª /
	if (path.startsWith(&quot;/&quot;)) {
		path = path.substring(1);
	}
	// çœŸæ­£æ‰§è¡ŒåŠ è½½æ‰€æœ‰ classpath èµ„æº
	Set&lt;Resource&gt; result = doFindAllClassPathResources(path);
	if (logger.isTraceEnabled()) {
		logger.trace(&quot;Resolved classpath location [&quot; + location + &quot;] to resources &quot; + result);
	}
	// è½¬æ¢æˆ Resource æ•°ç»„è¿”å›
	return result.toArray(new Resource[0]);
}
</code></pre>
<p>çœŸæ­£æ‰§è¡ŒåŠ è½½çš„æ˜¯åœ¨<code>#doFindAllClassPathResources(...)</code> æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-java">protected Set&lt;Resource&gt; doFindAllClassPathResources(String path) throws IOException {
	Set&lt;Resource&gt; result = new LinkedHashSet&lt;&gt;(16);
	ClassLoader cl = getClassLoader();
	// &lt;1&gt; æ ¹æ® ClassLoader åŠ è½½è·¯å¾„ä¸‹çš„æ‰€æœ‰èµ„æº
	Enumeration&lt;URL&gt; resourceUrls = (cl != null ? cl.getResources(path) : ClassLoader.getSystemResources(path));
	// &lt;2&gt;
	while (resourceUrls.hasMoreElements()) {
		URL url = resourceUrls.nextElement();
		// å°† URL è½¬æ¢æˆ UrlResource
		result.add(convertClassLoaderURL(url));
	}
	// &lt;3&gt; åŠ è½½è·¯å¾„ä¸‹å¾—æ‰€æœ‰ jar åŒ…
	if (&quot;&quot;.equals(path)) {
		// The above result is likely to be incomplete, i.e. only containing file system references.
		// We need to have pointers to each of the jar files on the classpath as well...
		addAllClassLoaderJarRoots(cl, result);
	}
	return result;
}
</code></pre>
<ul>
<li><code>&lt;1&gt;</code>å¤„ï¼Œæ ¹æ® ClassLoader åŠ è½½è·¯å¾„ä¸‹çš„æ‰€æœ‰èµ„æºã€‚åœ¨åŠ è½½èµ„æºè¿‡ç¨‹æ—¶ï¼Œå¦‚æœåœ¨æ„é€  PathMatchingResourcePatternResolver å®ä¾‹çš„æ—¶å€™å¦‚æœä¼ å…¥äº† ClassLoaderï¼Œåˆ™è°ƒç”¨è¯¥ ClassLoader çš„ <code>#getResources()</code>æ–¹æ³•ï¼Œå¦åˆ™è°ƒç”¨ <code>ClassLoader#getSystemResources(path)</code> æ–¹æ³•ã€‚å¦å¤–ï¼Œ<code>ClassLoader#getResources()</code>æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹:</li>
</ul>
<pre><code class="language-java">// java.lang.ClassLoader.java
public Enumeration&lt;URL&gt; getResources(String name) throws IOException {
    @SuppressWarnings(&quot;unchecked&quot;)
    Enumeration&lt;URL&gt;[] tmp = (Enumeration&lt;URL&gt;[]) new Enumeration&lt;?&gt;[2];
    if (parent != null) {
        tmp[0] = parent.getResources(name);
    } else {
        tmp[0] = getBootstrapResources(name);
    }
    tmp[1] = findResources(name);

    return new CompoundEnumeration&lt;&gt;(tmp);
}
</code></pre>
<p>çœ‹åˆ°è¿™é‡Œæ˜¯ä¸æ˜¯å°±å·²ç»ä¸€ç›®äº†ç„¶äº†ï¼Ÿå¦‚æœå½“å‰çˆ¶ç±»åŠ è½½å™¨ä¸ä¸º <code>null</code> ï¼Œåˆ™é€šè¿‡çˆ¶ç±»å‘ä¸Šè¿­ä»£è·å–èµ„æºï¼Œå¦åˆ™è°ƒç”¨ <code>#getBootstrapResources()</code> ã€‚è¿™é‡Œæ˜¯ä¸æ˜¯ç‰¹åˆ«ç†Ÿæ‚‰ï¼Œ(<sup>â–½</sup>)ã€‚</p>
<ul>
<li><code>&lt;2&gt;</code> å¤„ï¼Œéå† URL é›†åˆï¼Œè°ƒç”¨<code>#convertClassLoaderURL(URL url)</code>æ–¹æ³•ï¼Œå°† URL è½¬æ¢æˆ UrlResource å¯¹è±¡ã€‚ä»£ç å¦‚ä¸‹ï¼š</li>
</ul>
<pre><code class="language-java">protected Resource convertClassLoaderURL(URL url) {
	return new UrlResource(url);
}
</code></pre>
<ul>
<li><code>&lt;3&gt;</code> å¤„ï¼Œè‹¥ <code>path</code> ä¸ºç©ºï¼ˆ<code>&quot;&quot;</code>ï¼‰æ—¶ï¼Œåˆ™è°ƒç”¨ <code>#addAllClassLoaderJarRoots(...)</code>æ–¹æ³•ã€‚è¯¥æ–¹æ³•ä¸»è¦æ˜¯åŠ è½½è·¯å¾„ä¸‹å¾—æ‰€æœ‰ jar åŒ…ï¼Œæ–¹æ³•è¾ƒé•¿ä¹Ÿæ²¡æœ‰ä»€ä¹ˆå®é™…æ„ä¹‰å°±ä¸è´´å‡ºæ¥äº†ã€‚æ„Ÿå…´è¶£çš„èƒ–å‹ï¼Œè‡ªå·±å¯ä»¥å»çœ‹çœ‹ã€‚ğŸ˜ˆ å½“ç„¶ï¼Œå¯èƒ½ä»£ç ä¹Ÿæ¯”è¾ƒé•¿å“ˆã€‚</li>
</ul>
<p>é€šè¿‡ä¸Šé¢çš„åˆ†æï¼Œæˆ‘ä»¬çŸ¥é“<code>#findAllClassPathResources(...)</code> æ–¹æ³•ï¼Œå…¶å®å°±æ˜¯åˆ©ç”¨ ClassLoader æ¥åŠ è½½æŒ‡å®šè·¯å¾„ä¸‹çš„èµ„æºï¼Œä¸è®ºå®ƒæ˜¯åœ¨ class è·¯å¾„ä¸‹è¿˜æ˜¯åœ¨ jar åŒ…ä¸­ã€‚å¦‚æœæˆ‘ä»¬ä¼ å…¥çš„è·¯å¾„ä¸ºç©ºæˆ–è€…<code>/</code>ï¼Œåˆ™ä¼šè°ƒç”¨ <code>#addAllClassLoaderJarRoots(...)</code> æ–¹æ³•ï¼ŒåŠ è½½æ‰€æœ‰çš„ jar åŒ…ã€‚</p>
<h3 id="265-findpathmatchingresources">2.6.5 findPathMatchingResources</h3>
<p>å½“<code>locationPattern</code> ä¸­åŒ…å«äº†é€šé…ç¬¦ï¼Œåˆ™è°ƒç”¨è¯¥æ–¹æ³•è¿›è¡Œèµ„æºåŠ è½½ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-java">protected Resource[] findPathMatchingResources(String locationPattern) throws IOException {
    // ç¡®å®šæ ¹è·¯å¾„ã€å­è·¯å¾„
    String rootDirPath = determineRootDir(locationPattern);
    String subPattern = locationPattern.substring(rootDirPath.length());
    // è·å–æ ¹æ®è·¯å¾„ä¸‹çš„èµ„æº
    Resource[] rootDirResources = getResources(rootDirPath);
    // éå†ï¼Œè¿­ä»£
    Set&lt;Resource&gt; result = new LinkedHashSet&lt;&gt;(16);
    for (Resource rootDirResource : rootDirResources) {
        rootDirResource = resolveRootDirResource(rootDirResource);
        URL rootDirUrl = rootDirResource.getURL();
        // bundle èµ„æºç±»å‹
        if (equinoxResolveMethod != null &amp;&amp; rootDirUrl.getProtocol().startsWith(&quot;bundle&quot;)) {
            URL resolvedUrl = (URL) ReflectionUtils.invokeMethod(equinoxResolveMethod, null, rootDirUrl);
            if (resolvedUrl != null) {
                rootDirUrl = resolvedUrl;
            }
            rootDirResource = new UrlResource(rootDirUrl);
        }
        // vfs èµ„æºç±»å‹
        if (rootDirUrl.getProtocol().startsWith(ResourceUtils.URL_PROTOCOL_VFS)) {
            result.addAll(VfsResourceMatchingDelegate.findMatchingResources(rootDirUrl, subPattern, getPathMatcher()));
        // jar èµ„æºç±»å‹
        } else if (ResourceUtils.isJarURL(rootDirUrl) || isJarResource(rootDirResource)) {
            result.addAll(doFindPathMatchingJarResources(rootDirResource, rootDirUrl, subPattern));
        // å…¶å®ƒèµ„æºç±»å‹
        } else {
            result.addAll(doFindPathMatchingFileResources(rootDirResource, subPattern));
        }
    }
    if (logger.isTraceEnabled()) {
        logger.trace(&quot;Resolved location pattern [&quot; + locationPattern + &quot;] to resources &quot; + result);
    }
    // è½¬æ¢æˆ Resource æ•°ç»„è¿”å›
    return result.toArray(new Resource[0]);
}
</code></pre>
<p>æ–¹æ³•æœ‰ç‚¹å„¿é•¿ï¼Œä½†æ˜¯æ€è·¯è¿˜æ˜¯å¾ˆæ¸…æ™°çš„ï¼Œä¸»è¦åˆ†ä¸¤æ­¥ï¼š</p>
<ol>
<li>ç¡®å®šç›®å½•ï¼Œè·å–è¯¥ç›®å½•ä¸‹å¾—æ‰€æœ‰èµ„æºã€‚</li>
<li>åœ¨æ‰€è·å¾—çš„æ‰€æœ‰èµ„æºåï¼Œè¿›è¡Œè¿­ä»£åŒ¹é…è·å–æˆ‘ä»¬æƒ³è¦çš„èµ„æºã€‚</li>
</ol>
<p>åœ¨è¿™ä¸ªæ–¹æ³•é‡Œé¢ï¼Œæˆ‘ä»¬è¦å…³æ³¨ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯<code>#determineRootDir(String location)</code> æ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯ <code>#doFindPathMatchingXXXResources(...)</code> ç­‰æ–¹æ³•ã€‚</p>
<h4 id="2651-determinerootdir">2.6.5.1 determineRootDir</h4>
<p><code>determineRootDir(String location)</code> æ–¹æ³•ï¼Œä¸»è¦æ˜¯ç”¨äºç¡®å®šæ ¹è·¯å¾„ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-java">/**
 * Determine the root directory for the given location.
 * &lt;p&gt;Used for determining the starting point for file matching,
 * resolving the root directory location to a {@code java.io.File}
 * and passing it into {@code retrieveMatchingFiles}, with the
 * remainder of the location as pattern.
 * &lt;p&gt;Will return &quot;/WEB-INF/&quot; for the pattern &quot;/WEB-INF/*.xml&quot;,
 * for example.
 * @param location the location to check
 * @return the part of the location that denotes the root directory
 * @see #retrieveMatchingFiles
 */
protected String determineRootDir(String location) {
	// æ‰¾åˆ°å†’å·çš„åä¸€ä½
	int prefixEnd = location.indexOf(':') + 1;
	// æ ¹ç›®å½•ç»“æŸä½ç½®
	int rootDirEnd = location.length();
	// åœ¨ä»å†’å·å¼€å§‹åˆ°æœ€åçš„å­—ç¬¦ä¸²ä¸­ï¼Œå¾ªç¯åˆ¤æ–­æ˜¯å¦åŒ…å«é€šé…ç¬¦ï¼Œå¦‚æœåŒ…å«ï¼Œåˆ™æˆªæ–­æœ€åä¸€ä¸ªç”±â€/â€åˆ†å‰²çš„éƒ¨åˆ†ã€‚
	// ä¾‹å¦‚ï¼šåœ¨æˆ‘ä»¬è·¯å¾„ä¸­ï¼Œå°±æ˜¯æœ€åçš„ap?-context.xmlè¿™ä¸€æ®µã€‚å†å¾ªç¯åˆ¤æ–­å‰©ä¸‹çš„éƒ¨åˆ†ï¼Œç›´åˆ°å‰©ä¸‹çš„è·¯å¾„ä¸­éƒ½ä¸åŒ…å«é€šé…ç¬¦ã€‚
	while (rootDirEnd &gt; prefixEnd &amp;&amp; getPathMatcher().isPattern(location.substring(prefixEnd, rootDirEnd))) {
		rootDirEnd = location.lastIndexOf('/', rootDirEnd - 2) + 1;
	}
	// å¦‚æœæŸ¥æ‰¾å®Œæˆåï¼ŒrootDirEnd = 0 äº†ï¼Œåˆ™å°†ä¹‹å‰èµ‹å€¼çš„ prefixEnd çš„å€¼èµ‹ç»™ rootDirEnd ï¼Œä¹Ÿå°±æ˜¯å†’å·çš„åä¸€ä½
	if (rootDirEnd == 0) {
		rootDirEnd = prefixEnd;
	}
	// æˆªå–æ ¹ç›®å½•
	return location.substring(0, rootDirEnd);
}
</code></pre>
<p>æ–¹æ³•æ¯”è¾ƒç»•ï¼Œæ•ˆæœå¦‚ä¸‹ç¤ºä¾‹ï¼š</p>
<table>
<thead>
<tr>
<th>åŸè·¯å¾„</th>
<th>ç¡®å®šæ ¹è·¯å¾„</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>classpath*:test/cc*/spring-*.xml</code></td>
<td><code>classpath*:test/</code></td>
</tr>
<tr>
<td><code>classpath*:test/aa/spring-*.xml</code></td>
<td><code>classpath*:test/aa/</code></td>
</tr>
</tbody>
</table>
<h4 id="2652-dofindpathmatchingxxxresources">2.6.5.2 doFindPathMatchingXXXResources</h4>
<p><code>#doFindPathMatchingXXXResources(...)</code> æ–¹æ³•ï¼Œæ˜¯ä¸ªæ³›æŒ‡ï¼Œä¸€å…±å¯¹åº”ä¸‰ä¸ªæ–¹æ³•ï¼š</p>
<ul>
<li><code>#doFindPathMatchingJarResources(rootDirResource, rootDirUrl, subPatter)</code> æ–¹æ³•</li>
<li><code>#doFindPathMatchingFileResources(rootDirResource, subPattern)</code>æ–¹æ³•</li>
<li><code>VfsResourceMatchingDelegate#findMatchingResources(rootDirUrl, subPattern, pathMatcher)</code> æ–¹æ³•</li>
</ul>
<p>å› ä¸ºæœ¬æ–‡é‡åœ¨åˆ†æ Spring ç»Ÿä¸€èµ„æºåŠ è½½ç­–ç•¥çš„æ•´ä½“æµç¨‹ã€‚ç›¸å¯¹æ¥è¯´ï¼Œä¸Šé¢å‡ ä¸ªæ–¹æ³•çš„ä»£ç é‡ä¼šæ¯”è¾ƒå¤šã€‚æ‰€ä»¥æœ¬æ–‡ä¸å†è¿½æº¯ï¼Œæ„Ÿå…´è¶£çš„èƒ–å‹ï¼Œæ¨èé˜…è¯»å¦‚ä¸‹æ–‡ç« ï¼š</p>
<ul>
<li><a href="https://www.cnblogs.com/question-sky/p/6959493.html">ã€ŠSpringæºç æƒ…æ“é™¶å†¶-PathMatchingResourcePatternResolverè·¯å¾„èµ„æºåŒ¹é…æº¶è§£å™¨ã€‹</a> ï¼Œä¸»è¦é’ˆå¯¹ <code>#doFindPathMatchingJarResources(rootDirResource, rootDirUrl, subPatter)</code>æ–¹æ³•</li>
<li><a href="http://www.blogjava.net/DLevin/archive/2012/12/01/392337.html">ã€Šæ·±å…¥ Spring IoC æºç ä¹‹ ResourceLoaderã€‹</a> ï¼Œä¸»è¦é’ˆå¯¹ <code>#doFindPathMatchingFileResources(rootDirResource, subPattern)</code> æ–¹æ³•ã€‚</li>
<li><a href="http://www.coderli.com/spring-wildpath-parse/">ã€ŠSpring æºç å­¦ä¹  â€”â€” å«æœ‰é€šé…ç¬¦è·¯å¾„è§£æï¼ˆä¸Šï¼‰ã€‹</a></li>
</ul>
<h1 id="3-å°ç»“">3. å°ç»“</h1>
<p>è‡³æ­¤ Spring æ•´ä¸ªèµ„æºè®°è½½è¿‡ç¨‹å·²ç»åˆ†æå®Œæ¯•ã€‚ä¸‹é¢ç®€è¦æ€»ç»“ä¸‹ï¼š</p>
<ul>
<li>Spring æä¾›äº† Resource å’Œ ResourceLoader æ¥ç»Ÿä¸€æŠ½è±¡æ•´ä¸ªèµ„æºåŠå…¶å®šä½ã€‚ä½¿å¾—èµ„æºä¸èµ„æºçš„å®šä½æœ‰äº†ä¸€ä¸ªæ›´åŠ æ¸…æ™°çš„ç•Œé™ï¼Œå¹¶ä¸”æä¾›äº†åˆé€‚çš„ Default ç±»ï¼Œä½¿å¾—è‡ªå®šä¹‰å®ç°æ›´åŠ æ–¹ä¾¿å’Œæ¸…æ™°ã€‚</li>
<li>AbstractResource ä¸º Resource çš„é»˜è®¤æŠ½è±¡å®ç°ï¼Œå®ƒå¯¹ Resource æ¥å£åšäº†ä¸€ä¸ªç»Ÿä¸€çš„å®ç°ï¼Œå­ç±»ç»§æ‰¿è¯¥ç±»ååªéœ€è¦è¦†ç›–ç›¸åº”çš„æ–¹æ³•å³å¯ï¼ŒåŒæ—¶å¯¹äºè‡ªå®šä¹‰çš„ Resource æˆ‘ä»¬ä¹Ÿæ˜¯ç»§æ‰¿è¯¥ç±»ã€‚</li>
<li>DefaultResourceLoader åŒæ ·ä¹Ÿæ˜¯ ResourceLoader çš„é»˜è®¤å®ç°ï¼Œåœ¨è‡ªå®š ResourceLoader çš„æ—¶å€™æˆ‘ä»¬é™¤äº†å¯ä»¥ç»§æ‰¿è¯¥ç±»å¤–è¿˜å¯ä»¥å®ç° ProtocolResolver æ¥å£æ¥å®ç°è‡ªå®šèµ„æºåŠ è½½åè®®ã€‚</li>
<li>DefaultResourceLoader æ¯æ¬¡åªèƒ½è¿”å›å•ä¸€çš„èµ„æºï¼Œæ‰€ä»¥ Spring é’ˆå¯¹è¿™ä¸ªæä¾›äº†å¦å¤–ä¸€ä¸ªæ¥å£ ResourcePatternResolver ï¼Œè¯¥æ¥å£æä¾›äº†æ ¹æ®æŒ‡å®šçš„ locationPattern è¿”å›å¤šä¸ªèµ„æºçš„ç­–ç•¥ã€‚å…¶å­ç±» PathMatchingResourcePatternResolver æ˜¯ä¸€ä¸ªé›†å¤§æˆè€…çš„ ResourceLoader ï¼Œå› ä¸ºå®ƒå³å®ç°äº† <code>Resource getResource(String location)</code> æ–¹æ³•ï¼Œä¹Ÿå®ç°äº† <code>Resource[] getResources(String locationPattern)</code> æ–¹æ³•ã€‚</li>
</ul>
<p>å¦å¤–ï¼Œå¦‚æœèƒ–å‹è®¤çœŸçš„çœ‹äº†æœ¬æ–‡çš„åŒ…ç»“æ„ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼ŒResource å’Œ ResourceLoader æ ¸å¿ƒæ˜¯åœ¨ï¼Œspring-core é¡¹ç›®ä¸­ã€‚</p>
<p>å¦‚æœæƒ³è¦è°ƒè¯•æœ¬å°èŠ‚çš„ç›¸å…³å†…å®¹ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ Resource å’Œ ResourceLoader ç›¸å…³çš„ API ï¼Œè¿›è¡Œæ“ä½œè°ƒè¯•ã€‚</p>

							</div>
							<div class="wow bounceInDown vt-post-tags">
								
								<a href="https://xinrong2019.github.io/tag/y2uDFThMC/" rel="tag">Spring</a>
								
							</div>
							<nav class="navigation3 post-navigation3" role="navigation">

								<div class="nav-links3">
									
									<div class="wow bounceInLeft nav-previous3"><a href="https://xinrong2019.github.io/post/shi-yong-idea-dao-ru-gradle-xiang-mu-gou-jian-shi-yu-dao-de-wen-ti/"
											rel="prev"> ä½¿ç”¨IDEAå¯¼å…¥Gradleé¡¹ç›®æ„å»ºæ—¶é‡åˆ°çš„é—®é¢˜</a></div>
									
									
									<div class="wow bounceInRight nav-next3"><a href="https://xinrong2019.github.io/post/oracle-chuang-jian-biao-kong-jian-chuang-jian-yong-hu-de-wan-zheng-guo-cheng/"
											rel="next"> Oracleåˆ›å»ºè¡¨ç©ºé—´ã€åˆ›å»ºç”¨æˆ·çš„å®Œæ•´è¿‡ç¨‹</a></div>
									
								</div>
							</nav>
							<div class="wow rollIn author-info" style="visibility: visible; animation-name: rollIn;">
								<div class="author-avatar pull-left"><img
										src="https://xinrong2019.github.io//images/avatar.png"></div>
								
								<div class="author-description">
									<div class="author-title">
										<div class="author-link" rel="author">Kim</div>
									</div>
									
									
									<p class="author-bio">Time waits for no one.</p>
								</div>
							</div>
							
						</div>
					</article>
					<div id="marlin_lite_about_widget-2" class="wow bounceInUp widget marlin_lite_about_widget"
						data-wow-delay="0.1s">

						
						
						<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container"></div>

<script>

  var gitalk = new Gitalk({
    clientID: '2f13af052cedc58f1f20',
    clientSecret: 'ce03139f08944b2398d0f580a3d00ff58958c242',
    repo: 'xinrong2019.github.io',
    owner: 'xinrong2019',
    admin: ['xinrong2019'],
    id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })

  gitalk.render('gitalk-container')

</script>

						
						
						
						<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='https://xinrong2019.github.io//media/scripts/Valine.min.js'></script>

<div class="comment"></div>
<script>
        new Valine({
            // AV å¯¹è±¡æ¥è‡ªä¸Šé¢å¼•å…¥av-min.js(è€å¸æœºä»¬ä¸è¦å¼€è½¦â³â™¡ã‚›æ‰å¿ƒäº†è€é“)
            av: AV, 
            el: '.comment',
            lang: 'zh-cn',
            
            
     	
      	
          
        });
    </script> 


					</div>
				</div>
				<div class="tocc col l3 hide-on-med-and-down">

    <div class="toc-widget">

        <div class="toc-title"></div>

        <div id="toc-content">


        </div>
    </div>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.5.0/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '.entry-summary',
            headingsOffset: -($(window).height() * 0.4 - 45),
            // headingsOffset: -205,
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('.entry-summary').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });
    });

    $(function () {
        var bt;
        bt = $('.toc-widget');
        if ($(document).width() > 480) {
            $(window).scroll(function () {
                var st;
                st = $(window).scrollTop();
                if (st > 450) {
                    return bt.css('display', 'block');
                } else {
                    return bt.css('display', 'none');
                }
            })
        }
    });
</script>
			</div>
		</div>
		<footer id="colophon" class="site-footer">
	<div class="container">
		<div class="copyright">
			Created by Kim.
			<br>
			<b>Theme: </b>
			<a href="https://github.com/alterfang/gridea-theme-pan" target="_blank" title="Pan">
				<span><b>Pan</b></span>
			</a>
			<b>. Powered by </b>
			<a href="https://gridea.dev/" target="_blank" title="Gridea">
				<span><b>Gridea</b></span>
			</a>
		</div>
	</div><!-- .container -->
</footer><!-- #colophon -->
	</div>

	<script src="https://cdn.bootcss.com/fitvids/1.2.0/jquery.fitvids.min.js"></script>
<script type='text/javascript' src='https://xinrong2019.github.io//media/scripts/marlin-scripts.js'></script>
<script src="//tokinx.github.io/lately/lately.min.js"></script>
<script>
  jQuery(document).ready(function () {
    $.lately({
      'target': '.lately-a,.lately-b,.lately-c'
    })
  });
</script>
<style type="text/css">
  /* ä¸€é”®åˆ°é¡¶éƒ¨ */
  a.back_to_top {
    text-decoration: none;
    position: fixed;
    bottom: 65px;
    right: 30px;
    background: #f0f0f0;
    height: 40px;
    width: 40px;
    border-radius: 50%;
    line-height: 36px;
    font-size: 18px;
    text-align: center;
    transition-duration: .5s;
    transition-propety: background-color;
    display: none;
  }

  a.back_to_top span {
    color: #888;
  }

  a.back_to_top:hover {
    cursor: pointer;
    background: #dfdfdf;
  }

  a.back_to_top:hover span {
    color: #555;
  }

  @media print,
  screen and (max-width: 580px) {
    .back_to_top {
      display: none !important;
    }
  }

  /* ä¸€é”®åˆ°åº•éƒ¨ */

  a.down_to_bottom {
    text-decoration: none;
    position: fixed;
    bottom: 15px;
    right: 30px;
    background: #f0f0f0;
    height: 40px;
    width: 40px;
    border-radius: 50%;
    line-height: 36px;
    font-size: 18px;
    text-align: center;
    transition-duration: .5s;
    transition-propety: background-color;
    display: none;
  }

  a.down_to_bottom span {
    color: #888;
  }

  a.down_to_bottom:hover {
    cursor: pointer;
    background: #dfdfdf;
  }

  a.down_to_bottom:hover span {
    color: #555;
  }

  @media print,
  screen and (max-width: 580px) {
    .down_to_bottom {
      display: none !important;
    }
  }
</style>


<a id="back_to_top" href="#" class="back_to_top"><span><i class="iconfont icon-xiangshang"></i></span>
</a>

<a id="down_to_bottom" href="#" class="down_to_bottom"><span><i class="iconfont icon-xiangxia"></i></span>
</a>

<script src="//instant.page/3.0.0" type="module" defer
  integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>

<script>
  function getScrollTop() {
    var scrollTop = 0,
      bodyScrollTop = 0,
      documentScrollTop = 0;
    if (document.body) {
      bodyScrollTop = document.body.scrollTop;
    }
    if (document.documentElement) {
      documentScrollTop = document.documentElement.scrollTop;
    }
    scrollTop = (bodyScrollTop - documentScrollTop > 0) ? bodyScrollTop : documentScrollTop;
    return scrollTop;
  };

  function getScrollHeight() {
    var scrollHeight = 0,
      bodyScrollHeight = 0,
      documentScrollHeight = 0;
    if (document.body) {
      bSH = document.body.scrollHeight;
    }
    if (document.documentElement) {
      dSH = document.documentElement.scrollHeight;
    }
    scrollHeight = (bSH - dSH > 0) ? bSH : dSH;
    return scrollHeight;
  };

  function getWindowHeight() {
    var windowHeight = 0;
    if (document.compatMode == "CSS1Compat") {
      windowHeight = document.documentElement.clientHeight;
    } else {
      windowHeight = document.body.clientHeight;
    }
    return windowHeight;
  };

  $(document).ready((function (_this) {
    return function () {
      var bt;
      bt = $('#back_to_top');
      if ($(document).width() > 480) {
        $(window).scroll(function () {
          var st;
          st = $(window).scrollTop();
          if (st > 30) {
            return bt.css('display', 'block');
          } else {
            return bt.css('display', 'none');
          }
        });
        return bt.click(function () {
          $('body,html').animate({
            scrollTop: 0
          }, 800);
          return false;
        });
      }
    };
  })(this));

  $(document).ready((function (_this) {
    return function () {
      var bt;
      bt = $('#down_to_bottom');
      if ($(document).width() > 480) {
        $(window).scroll(function () {
          var st;
          st = $(window).scrollTop();
          if (getScrollTop() + getWindowHeight() == getScrollHeight()) {
            return bt.css('display', 'none');
          } else {
            return bt.css('display', 'block');
          }
        });
        return bt.click(function () {
          $('body,html').animate({
            scrollTop: $('body,html')[0].scrollHeight
          }, 800);
          return false;
        });
      }
    };
  })(this));
</script>
	<script data-no-instant>
		(function ($) {
			$.extend({
				adamsOverload: function () {
					$('.navigation:eq(0)').remove();
					$("").attr("rel", "external");
					$("a[rel='external'],a[rel='external nofollow']").attr("target", "_blank");
					$("a.vi").attr("rel", "");
					$.viewImage({
						'target': 'img',
						'exclude': '.vsmile-icons img,.gallery img',
						'delay': 300
					});
					$.lately({
						'target': '.commentmetadata a,.infos time,.post-list time'
					});
					prettyPrint();

					$('ul.links li a').each(function () {
						if ($(this).parent().find('.bg').length == 0) {
							$(this).parent().append(
								'<!---<div class="bg" style="background-image:url(https://c3.glgoo.top/s2/favicons?domain=' +
								$(this).attr("href") + ')"></div>--->')
						}
					});
				}
			});
		})(jQuery);
		jQuery.adamsOverload();
	</script>

</body>

</html>